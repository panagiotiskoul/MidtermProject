<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A Hiking Trip Booking & Equipement Rental Website">
    <meta name="author" content="Panos North">
    <title>North Hiking</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="icon" type="image/png" href="images/Site_Logo/favicon.png">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="taskstyles.css"> <!-- Link to external CSS -->
</head>


<body>
    <!-- Script that Animates the Logo Image of the Navbar -->
    <script>
        // Wait for the document to be fully loaded before executing the script
        $(document).ready(function() {
            
            // When the mouse enters the logo image
            $(".navbar-brand img").hover(
                function() {
                    // This function is triggered when the mouse enters the image
                    $(this).attr("src", "./images/Site_Logo/logo-hover.png"); // Change the image source to the hover version
                }, 
                function() {
                    // This function is triggered when the mouse leaves the image
                    $(this).attr("src", "./images/Site_Logo/logo.png"); // Change the image source back to the original version
                }
            );
        });
    </script>


    <header>
        <!-- Main navigation bar -->
        <nav id="navbar" class="navbar navbar-expand-md navbar-light bg-light sticky-top" aria-label="Navigation menu">
            <div class="container-fluid">
                
                <!-- Logo and home link -->
                <a class="navbar-brand" href="index.html">
                    <img src="./images/Site_Logo/logo.png" alt="North Hiking Trips Logo" class="logo-img">
                </a>

                <!-- Mobile menu toggle button (visible on small screens) -->
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" 
                    aria-controls="navbarSupportedContent" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Collapsible menu that appears on larger screens -->
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <!-- Navigation links (Home, Trips, Tasks, About, Contact) -->
                    <ul class="navbar-nav d-flex flex-grow-1 justify-content-between text-center navlinks" role="menu">
                        <li class="nav-item flex-fill" role="none"><a class="nav-link" href="index.html" role="menuitem">Home</a></li>
                        <li class="nav-item flex-fill" role="none"><a class="nav-link" href="trips.html" role="menuitem">Trips</a></li>
                        <li class="nav-item flex-fill" role="none"><a class="nav-link active" aria-current="page" href="tasks.html" role="menuitem">Tasks</a></li>
                        <li class="nav-item flex-fill" role="none"><a class="nav-link" href="about.html" role="menuitem">About</a></li>
                        <li class="nav-item flex-fill" role="none"><a class="nav-link" href="contact.html" role="menuitem">Contact</a></li>
                    </ul>

                    <!-- Dark Mode Toggle Button -->
                    <div class="dark-mode-container">
                        <button id="darkModeToggle" class="btn btn-primary" type="button" aria-label="Toggle dark mode">
                            Dark
                        </button>
                    </div>

                    <!-- Search form -->
                    <form class="d-flex justify-content-center" role="search" aria-label="Site search">
                        <!-- Search input field -->
                        <input class="form-control me-2 searchnav" type="search" placeholder="Search" aria-label="Search query">
                        <!-- Submit button for the search -->
                        <button class="btn btn-outline-success" type="submit" aria-label="Submit search">Search</button>
                    </form>
                </div>
            </div>
        </nav>
    </header>

    <!-- Script that applies Darkmode to the website -->
    <script>
        $(document).ready(function(){
            // Check if dark mode is enabled from localStorage and apply it
            if(localStorage.getItem("darkMode") === "enabled") {
                $("body").addClass("dark-background");
                $("p, h1, h2, h3, h4, h5, h6").addClass("light-text");
                $("#navbar").addClass("navbar-dark bg-dark").removeClass("navbar-light bg-light");
                $("#welcome").addClass("welcome-box-dark").removeClass("welcome-box");
                $("#footer").addClass("footer-dark");
                $("#darkModeToggle").text("Light");
                $("hr").addClass("seperator"); // Add .separator to all <hr> elements
                $(".contact-form label").css("color", "white");
                $(".contact-form textarea, .contact-form input, .contact-form select").css({
                        "background-color": "#333840", // Dark gray background
                        "color": "white" // White text color
                    });
                    $(".contact-form select option").css("color", "white"); // White text in select options
            }

            // Handle button click for dark mode toggle
            $("#darkModeToggle").click(function(){
                // Toggle classes for dark mode
                $("#navbar").toggleClass("navbar-light navbar-dark bg-light bg-dark");

                // Toggle background color of the page
                $("body").toggleClass("dark-background");

                // Toggle text color for paragraphs and headers
                $("p, h1, h2, h3, h4, h5, h6").toggleClass("light-text");

                // Toggle welcome-box classes for the #welcome div
                $("#welcome").toggleClass("welcome-box-dark welcome-box");

                // Toggle footer-dark class on footer
                $("#footer").toggleClass("footer-dark");

                // Toggle .separator class on all <hr> elements
                $("hr").toggleClass("separator");


                // CToggle Dark Mode for the Contact Form Labels
                // Check the color of the first label
                var currentColor = $(".contact-form label").first().css("color");
                // If the color is rgb(33, 37, 41), change it to white, otherwise change to rgb(33, 37, 41)
                if (currentColor === "rgb(33, 37, 41)") {
                    $(".contact-form label").css("color", "white");
                } else if (currentColor === "rgb(255, 255, 255)") {
                    $(".contact-form label").css("color", "rgb(33, 37, 41)");
                }


                // Toggle Dark Mode for the contact form fields
                var currentfieldColor = $(".contact-form textarea").first().css("background-color");
                if (currentfieldColor === "rgb(255, 255, 255)") { 
                    $(".contact-form textarea, .contact-form input, .contact-form select").css({
                        "background-color": "#333840", // Dark gray background
                        "color": "white" // White text color
                    });
                    $(".contact-form select option").css("color", "white"); // White text in select options
                } else {
                    $(".contact-form textarea, .contact-form input, .contact-form select").css({
                        "background-color": "white", // Light background
                        "color": "rgb(33, 37, 41)" // Dark text color
                    });
                    $(".contact-form select option").css("color", "rgb(33, 37, 41)"); // Dark text in select options
                }


                // Change the button text between "Dark" and "Light"
                var buttonText = $("#darkModeToggle").text().trim();
                if (buttonText === "Dark") {
                    $("#darkModeToggle").text("Light");
                    localStorage.setItem("darkMode", "enabled"); // Save dark mode state
                } else {
                    $("#darkModeToggle").text("Dark");
                    localStorage.setItem("darkMode", "disabled"); // Save dark mode state
                }
            });
        });
    </script>
    


    <div class="itemsmargins">
        <main class="container mt-4">
            <!-- Form for adding items -->
            <div class="form-container">
                <!-- Heading for the form -->
                <h2 class="text-center" id="formHeading">Create your Checklist</h2>
                <form id="itemForm" aria-labelledby="formHeading">
        
                    <div class="row">
                        <!-- Trip Date input field (selected once) -->
                        <div class="col-md-6 mb-3">
                            <label for="tripDate" class="form-label" aria-label="Select Trip Date">Select Trip Date:</label>
                            <input type="date" id="tripDate" name="tripDate" class="form-control" required aria-required="true">
                        </div>
                    </div>
        
                    <!-- Grid layout for Item Name, Quantity, Priority, and Description -->
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <!-- Item Name input field -->
                            <label for="itemName" aria-label="Enter item name">Item Name:</label>
                            <input type="text" id="itemName" name="itemName" class="form-control" required aria-required="true" aria-placeholder="Enter the name of the item">
                        </div>
        
                        <div class="col-md-3 mb-3">
                            <!-- Quantity input field (ensures a minimum of 1 item) -->
                            <label for="quantity" aria-label="Enter item quantity">Quantity:</label>
                            <input type="number" id="quantity" name="quantity" class="form-control" required min="1" aria-required="true" aria-placeholder="Enter the number of items">
                        </div>
        
                        <div class="col-md-3 mb-3">
                            <!-- Priority dropdown with options: High, Medium, Low -->
                            <label for="priority" aria-label="Select item priority">Priority:</label>
                            <select id="priority" name="priority" class="form-select" required aria-required="true">
                                <option value="High">High</option>
                                <option value="Medium">Medium</option>
                                <option value="Low">Low</option>
                            </select>
                        </div>
        
                        <div class="col-md-12">
                            <!-- Item Description input field -->
                            <label for="itemDesc" aria-label="Enter item description">Description:</label>
                            <input type="text" id="itemDesc" name="itemDesc" class="form-control" required aria-required="true" aria-placeholder="Enter a description for the item">
                        </div>
                    </div><br>
        
                    <!-- Buttons to add or update items -->
                    <button type="button" id="addItemBtn" class="btn btn-primary" aria-label="Add item to the list">Add Item</button>
                    <button type="button" id="updateItemBtn" class="btn btn-warning" style="display:none;" aria-label="Update selected item">Update Item</button>
                </form>
            </div>
        
            <!-- Section to display the list of items -->
            <h3 id="itemListHeading" aria-label="Item List">Item List</h3>
            <table class="table items" aria-labelledby="itemListHeading">
                <thead>
                    <!-- Table headers for item details -->
                    <tr>
                        <th scope="col" aria-label="Mark item as complete">Complete</th>
                        <th scope="col" aria-label="Item name">Item Name</th>
                        <th scope="col" aria-label="Item description">Description</th>
                        <th scope="col" aria-label="Trip date">Trip Date</th>
                        <th scope="col" aria-label="Quantity of items">Quantity</th>
                        <th scope="col" aria-label="Priority level of item">Priority</th>
                        <th scope="col" aria-label="Actions for item">Actions</th>
                    </tr>
                </thead>
                <tbody id="itemTable">
                    <!-- New rows with item data will be added dynamically here -->
                </tbody>
            </table>

            <!-- Section for displaying an overview of item status -->
            <h3 id="statusOverviewHeading" aria-label="Item Status Overview">Item Status Overview</h3>
            <table class="table" aria-labelledby="statusOverviewHeading">
                <thead>
                    <!-- Table headers for status overview -->
                    <tr>
                        <th scope="col" aria-label="Item status type">Item Status</th>
                        <th scope="col" aria-label="Count of items in each status">Count</th>
                    </tr>
                </thead>
                <tbody id="statusTable">
                    <!-- Rows to display counts of packed, pending, and total items -->
                    <tr>
                        <td>Packed Items</td>
                        <td id="packedCount" aria-label="Number of packed items">0</td>
                    </tr>
                    <tr>
                        <td>Pending Items</td>
                        <td id="pendingCount" aria-label="Number of pending items">0</td>
                    </tr>
                    <tr>
                        <td>Total Items</td>
                        <td id="totalCount" aria-label="Total number of items">0</td>
                    </tr>
                </tbody>
            </table>


            <script>
                $(document).ready(function () {
                    var selectedTripDate = ""; // Variable to store selected Trip Date
                    var selectedRow = null; // To keep track of the selected row for editing
                    var packedItemsCount = 0; // Track the number of packed items
                    var pendingItemsCount = 0; // Track the number of pending items
                    
                    // Load the saved table rows from localStorage when the page loads
                    loadTableRowsFromLocalStorage();
                    
                    // Listen for Trip Date selection
                    $("#tripDate").change(function() {
                        selectedTripDate = $(this).val(); // Store the selected trip date
                    });

                    // Add Item Button
                    $("#addItemBtn").click(function () {
                        var itemName = $("#itemName").val();
                        var itemDesc = $("#itemDesc").val();
                        var quantity = $("#quantity").val();
                        var priority = $("#priority").val();
                        var tripDate = selectedTripDate;

                        // Validate if all fields are filled
                        if (itemName && itemDesc && tripDate && quantity && priority) {
                            var rowClass = "";
                            if (priority === "High") {
                                rowClass = "table-danger"; // Red for high priority
                            } else if (priority === "Medium") {
                                rowClass = "table-warning"; // Yellow for medium priority
                            } else if (priority === "Low") {
                                rowClass = "table-success"; // Green for low priority
                            }

                            pendingItemsCount++; // Increment pending items count

                            // Create a new row with a checkbox to mark as completed
                            var newRow = {
                                itemName: itemName,
                                itemDesc: itemDesc,
                                quantity: quantity,
                                priority: priority,
                                tripDate: tripDate,
                                isCompleted: false
                            };

                            // Add the new row to localStorage
                            saveRowToLocalStorage(newRow);

                            // Append the new row to the table
                            appendRowToTable(newRow);

                            // Clear the form fields, but keep the trip date
                            $("#itemForm")[0].reset();
                            $("#tripDate").val(selectedTripDate);

                            // Update the counts after adding an item
                            updateItemCounts();
                        } else {
                            alert("Please fill in all the fields.");
                        }
                    });

                    // Edit Item Button
                    $(document).on("click", ".editBtn", function() {
                        selectedRow = $(this).closest("tr");

                        // Populate the form with the current row's data
                        $("#itemName").val(selectedRow.find("td:eq(1)").text());
                        $("#itemDesc").val(selectedRow.find("td:eq(2)").text());
                        $("#quantity").val(selectedRow.find("td:eq(4)").text());
                        $("#priority").val(selectedRow.find("td:eq(5)").text());
                        $("#tripDate").val(selectedRow.find("td:eq(3)").text());

                        // Change the Add button to Update button
                        $("#addItemBtn").hide();
                        $("#updateItemBtn").show();
                    });

                    // Update Item Button (Handles Update)
                    $("#updateItemBtn").click(function() {
                        var itemName = $("#itemName").val();
                        var itemDesc = $("#itemDesc").val();
                        var quantity = $("#quantity").val();
                        var priority = $("#priority").val();
                        var tripDate = $("#tripDate").val();

                        if (selectedRow) {
                            selectedRow.find("td:eq(1)").text(itemName);
                            selectedRow.find("td:eq(2)").text(itemDesc);
                            selectedRow.find("td:eq(3)").text(tripDate);
                            selectedRow.find("td:eq(4)").text(quantity);
                            selectedRow.find("td:eq(5)").text(priority);

                            var rowClass = "";
                            if (priority === "High") {
                                rowClass = "table-danger";
                            } else if (priority === "Medium") {
                                rowClass = "table-warning";
                            } else if (priority === "Low") {
                                rowClass = "table-success";
                            }

                            selectedRow.removeClass("table-danger table-warning table-success");
                            selectedRow.addClass(rowClass);

                            // Update the row in localStorage
                            updateRowInLocalStorage(selectedRow, itemName, itemDesc, quantity, priority, tripDate);

                            $("#updateItemBtn").hide();
                            $("#addItemBtn").show();

                            $("#itemForm")[0].reset();
                            $("#tripDate").val(selectedTripDate);

                            updateItemCounts();
                        } else {
                            alert("Please select an item to update.");
                        }
                    });

                    // Delete Item Button
                    $(document).on("click", ".deleteBtn", function() {
                        var row = $(this).closest("tr");
                        var isCompleted = row.hasClass("table-success");

                        if (isCompleted) {
                            packedItemsCount--; // Decrement packed items count
                        } else {
                            pendingItemsCount--; // Decrement pending items count
                        }

                        row.remove(); // Remove the item row
                        deleteRowFromLocalStorage(row); // Delete the row from localStorage
                        updateItemCounts(); // Update the counts
                    });

                    // Track completion status of the tasks
                    $(document).on("change", ".completeCheckbox", function() {
                        var isCompleted = $(this).prop("checked");
                        var row = $(this).closest("tr");

                        if (isCompleted) {
                            row.addClass("table-success");
                            packedItemsCount++; // Increment packed items count
                            pendingItemsCount--; // Decrement pending items count
                        } else {
                            row.removeClass("table-success");
                            packedItemsCount--; // Decrement packed items count
                            pendingItemsCount++; // Increment pending items count
                        }

                        // Update the row status in localStorage
                        updateRowStatusInLocalStorage(row, isCompleted);

                        // Update the counts after completion status change
                        updateItemCounts();
                    });

                    // Function to update the counts (Packed, Pending, Total)
                    function updateItemCounts() {
                        var totalItemsCount = packedItemsCount + pendingItemsCount;

                        // Update the table with the current counts
                        $("#packedCount").text(packedItemsCount);
                        $("#pendingCount").text(pendingItemsCount);
                        $("#totalCount").text(totalItemsCount);
                    }

                    // Function to append row to table
                    function appendRowToTable(rowData) {
                        var rowClass = "";
                        if (rowData.priority === "High") {
                            rowClass = "table-danger";
                        } else if (rowData.priority === "Medium") {
                            rowClass = "table-warning";
                        } else if (rowData.priority === "Low") {
                            rowClass = "table-success";
                        }

                        var newRow = `<tr class="${rowClass}">
                            <td><input type="checkbox" class="completeCheckbox" ${rowData.isCompleted ? "checked" : ""}></td>
                            <td>${rowData.itemName}</td>
                            <td>${rowData.itemDesc}</td>
                            <td>${rowData.tripDate}</td>
                            <td>${rowData.quantity}</td>
                            <td>${rowData.priority}</td>
                            <td><button class="btn btn-warning editBtn">Edit</button> 
                                <button class="btn btn-danger deleteBtn">Delete</button>
                            </td>
                        </tr>`;

                        $("#itemTable").append(newRow);
                    }

                    // Function to save a row to localStorage
                    function saveRowToLocalStorage(rowData) {
                        var rows = JSON.parse(localStorage.getItem("itemRows")) || [];
                        rows.push(rowData);
                        localStorage.setItem("itemRows", JSON.stringify(rows));
                    }

                    // Function to load rows from localStorage
                    function loadTableRowsFromLocalStorage() {
                        var rows = JSON.parse(localStorage.getItem("itemRows")) || [];
                        rows.forEach(function(rowData) {
                            appendRowToTable(rowData);
                            if (rowData.isCompleted) {
                                packedItemsCount++;
                            } else {
                                pendingItemsCount++;
                            }
                        });
                        updateItemCounts();
                    }

                    // Function to update a row in localStorage
                    function updateRowInLocalStorage(rowElement, itemName, itemDesc, quantity, priority, tripDate) {
                        var rows = JSON.parse(localStorage.getItem("itemRows")) || [];
                        var rowIndex = rowElement.index();
                        var updatedRow = {
                            itemName: itemName,
                            itemDesc: itemDesc,
                            quantity: quantity,
                            priority: priority,
                            tripDate: tripDate,
                            isCompleted: rowElement.find("input.completeCheckbox").prop("checked")
                        };
                        rows[rowIndex] = updatedRow;
                        localStorage.setItem("itemRows", JSON.stringify(rows));
                    }

                    // Function to delete a row from localStorage
                    function deleteRowFromLocalStorage(rowElement) {
                        var rows = JSON.parse(localStorage.getItem("itemRows")) || [];
                        var rowIndex = rowElement.index();
                        rows.splice(rowIndex, 1);
                        localStorage.setItem("itemRows", JSON.stringify(rows));
                    }

                    // Function to update row completion status in localStorage
                    function updateRowStatusInLocalStorage(rowElement, isCompleted) {
                        var rows = JSON.parse(localStorage.getItem("itemRows")) || [];
                        var rowIndex = rowElement.index();
                        rows[rowIndex].isCompleted = isCompleted;
                        localStorage.setItem("itemRows", JSON.stringify(rows));
                    }
                });
            </script>

        </main>
    </div>
    
    
    <!-- Footer --> 
    <footer id="footer" class="text-center text-lg-start text-muted" aria-label="Footer">

        <!-- Section: Links  -->
        <section class="">
            <div class="container mt-5">
            <!-- Grid row -->
                <div class="row mt-3">
                    <!-- Grid column -->
                    <div class="col-md-3 col-lg-4 col-xl-3 mx-auto mb-4" aria-label="Legal and Policy Links">
                        <!-- Content -->
                        <h6 class="text-uppercase fw-bold mb-4">
                            <i class="fa-solid fa-mountain"></i>&nbsp;&nbsp;North Hiking
                        </h6>
                        <p>
                            <a href="#" class="text-reset">FAQ</a>
                        </p>
                        <p>
                            <a href="#" class="text-reset">Privacy Policy</a>
                        </p>
                        <p>
                            <a href="#" class="text-reset">Terms & Conditions</a>
                        </p>
                        <p>
                            <a href="#" class="text-reset">Legal Notice</a>
                        </p>
                    </div>

                    <div class="col-md-2 col-lg-2 col-xl-2 mx-auto mb-4" aria-label="Navigation Links">
                    <!-- Links -->
                        <h6 class="text-uppercase fw-bold mb-4">
                            Navigation
                        </h6>
                        <p>
                            <a href="index.html" class="text-reset">Home</a>
                        </p>
                        <p>
                            <a href="trips.html" class="text-reset">Trips</a>
                        </p>
                        <p>
                            <a href="tasks.html" class="text-reset">Tasks</a>
                        </p>
                        <p>
                            <a href="about.html" class="text-reset">About</a>
                        </p>
                        <p>
                            <a href="contact.html" class="text-reset">Contact</a>
                        </p>
                    </div>
                    <!-- Grid column -->

                    <!-- Social Media Links -->
                    <div class="col-md-2 col-lg-2 col-xl-2 mx-auto mb-4" aria-label="Social Media Links">
                        <!-- Links -->
                            <h6 class="text-uppercase fw-bold mb-4">
                                Social Media
                            </h6>
                            <p>
                                <a href="https://www.facebook.com/" class="text-reset">Facebook</a>
                                <i class="fab fa-facebook-f"></i>
                            </p>
                            <p>
                                <a href="https://www.instagram.com/" class="text-reset">Instagram</a>
                                <i class="fab fa-instagram"></i>
                            </p>
                            <p>
                                <a href="https://www.tiktok.com/" class="text-reset">TikTok</a>
                                <i class="fab fa-tiktok"></i>
                            </p>
                        </div>
                        <!-- Grid column -->
        
                    <!-- Grid column -->
                    <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mb-md-0 mb-4" aria-label="Contact Information">
                        <!-- Links -->
                        <h6 class="text-uppercase fw-bold mb-4">Contact</h6>
                        <p><i class="fas fa-home me-3"></i> Athens, 12649, Greece</p>
                        <p>
                            <i class="fas fa-envelope me-3"></i>
                            north_hiking@gmail.com
                        </p>
                        <p><i class="fas fa-phone me-3"></i> +30 210 810 2994</p>
                    </div>
                    <!-- Grid column -->
                </div>
                <!-- Grid row -->

                <!-- Copyright -->
                <div class="text-center" aria-label="Copyright Information">
                    © 2025 Copyright: Panos North
                </div>
                <!-- Copyright -->
            </div>
        </section>
        <!-- Section: Links  -->
    </footer>
    <!-- Footer -->

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>
